\chapter{Комбинаторика}
\section{Размещения}

\begin{utv}
    \textbf{Размещения без повторений} - это упорядоченный набор из $k$ различных 
    элементов из некоторого множества различных $n$ элементов, если $k \leq n$.
    \begin{equation}
        A^k_n = n(n-1)...(n-k+1)=\frac{n!}{(n-k)!}
    \end{equation}
\end{utv}

Предположим, у нас есть множество чисел $\{1, 2, 3\}$. Как можно разместить 2 различных элемента из
этого множества?

\begin{equation*}
    \{1, 2\}, \{2, 1\}, \{1, 3\}, \{3, 1\}, \{2, 3\}, \{3, 2\}
\end{equation*}

Докажем количество с помощью формулы,
\begin{equation*}
    A^2_3 = \frac{3!}{1!} = 1 \cdot 2 \cdot 3 = 6
\end{equation*}

Можно заметить, что $\{1, 2\}$ и $\{2, 1\}$ это два разных способа размещения.
Так же в этом случае элементы не могут повторяться. Если мы хотим, чтобы они повторялись, следует рассмотреть
\textbf{размещения с повторениями}.

\begin{utv}
    \textbf{Размещения с повторениями} - это упорядоченный набор из k элементов из некоторого
    множества различных n элементов при условии, что элементы из этой выборки могут повторяться.
    \begin{equation}
        A^k_n = n^k
    \end{equation}
\end{utv}

Рассмотрим тот же пример. У нас есть множество $\{1, 2, 3\}$. Сколько существует способов разместить 2 элемента
с повторениями?
\begin{equation*}
    \{1, 1\}, \{2, 2\}, \{3, 3\}, \{1, 2\}, ..., \{2, 3\}, \{3, 2\}
\end{equation*}

Посмотрим количество, используя формулу.
\begin{equation*}
    A^2_3 = 3^2 = 9
\end{equation*}
То есть, в данном случае, мы можем к предыдущему ответу (6) прибавить 3, то есть 3 пары одинаковых элементов.
\begin{remark*}
    Если бы $k$ был равен 3, то пришлось бы учитывать такие размещения как $\{1, 1, 2\}$. То есть
    повторяться числа могут сколько угодно.
\end{remark*}

А что если мы не хотим учитывать порядок элементов? С этим нам помогут \textbf{сочетания}.
\section{Сочетания}
У нас все так же есть множество чисел $\{1, 2, 3\}$. Сколькими способами мы можем выбрать 2 элемента из 
этого множества (множества из 3-х элементов)?

\begin{utv}
    \textbf{Сочетания без повторений} - это способ выбрать k из n различных предметов
    без учета порядка.
    \begin{equation}
        C^k_n = \frac{A^k_n}{k!} = \frac{n \cdot (n-1) \cdot ... \cdot (n-k)}{k!} = \frac{n!}{k!(n-k)!}
    \end{equation}
\end{utv}
То есть ответом на наш вопрос будут наборы:
\begin{equation*}
    \{1, 2\}, \{1, 3\}, \{2, 3\}
\end{equation*}
И их количество покажем используя формулу:
\begin{equation*}
    C^2_3 = \frac{3!}{2!(3-2)!} = 3
\end{equation*}

Можно заметить, что порядок не учитывался, в отличие от размещений.

Теперь отвлечемся и вспомним, что такое \textbf{бином Ньютона}.
\begin{utv}
    \textbf{Бином Ньютона} - это формула для разложения на отдельные слагаемые целой
    неотрицательной степени суммы двух переменных, имеющая вид
    \begin{equation}
        (a + b)^n = \sum_{k = 0}^{n} a^k b^{n-k} C^k_n 
    \end{equation}
    где $C^k_n$ - биномиальные коэффициенты, $n$ - неотрицательное целое число.
\end{utv}
Например,
\begin{gather}\label{binom_examples}
    (x + y)^2 = x^0y^2 + x^1y^1C^1_2 + x^2y^0 = x^2 + 2xy + y^2 \\
    (x + y)^3 =  x^0y^3 + x^1y^2C^1_3 + x^2y^1C^2_3 + x^3y^0 = x^3 + 3xy^2 + 3x^2y + y^3
\end{gather}

Считать таким образом бином Ньютона можно долго, но чтобы упростить задачу
мы можем вычислять только биномиальные коэффициенты, используя треугольник Паскаля.

\begin{utv}
    \textbf{Треугольник Паскаля} - бесконечная таблица биномиальных коэффициентов, 
    имеющая треугольную форму. В этом треугольнике на вершине и по бокам стоят единицы. 
    Каждое число равно сумме двух расположенных над ним чисел. Строки треугольника симметричны 
    относительно вертикальной оси.

    \begin{table}[h]
        \centering
        \begin{tabular}[c]{ l l l l l l l l l}
             &  &  &  & 1 &  &  &  &  \\
             &  &  & 1 &  & 1 &  &  &  \\
             &  & 1 &  & 2 &  & 1 &  &  \\
             & 1 &  & 3 &  & 3 &  & 1 &  \\
            1 &  & 4 &  & 6 &  & 4 &  & 1
        \end{tabular}
    \end{table}
    
    Или в виде сочетаний:
    \begin{table}[h]
        \centering
        \begin{tabular}[c]{ l l l l l l l l l}
             &  &  &  & $C^0_0$ &  &  &  &  \\
             &  &  & $C^0_1$ &  & $C^1_1$ &  &  &  \\
             &  & $C^0_2$ &  & $C^1_2$ &  & $C^2_2$ &  &  \\
             & $C^0_3$ &  & $C^1_3$ &  & $C^2_3$ &  & $C^3_3$ &  \\
             $C^0_4$ &  & $C^1_4$ &  & $C^2_4$ &  & $C^3_4$ &  & $C^4_4$
        \end{tabular}
    \end{table}
    
\end{utv}

С его помощью можно быстро находить биномиальные коэффициенты, где номер строки является
числом $n$ в биноме Ньютона. Следует учесть, что строки нумеруются от 0.

Таким образом, коэффициенты из формулы \ref{binom_examples} можно вывести используя треугольник Паскаля.

Дополнительно, можно прийти к такому следствию:
\begin{sle}
    С помощью треугольника Паскаля можно вывести закономерность:
    \begin{equation}
        C^k_n = C^k_{n-1} + C^{k-1}_{n-1}
    \end{equation}
\end{sle}

Теперь зададимся вопросом по аналогии с размещениями. А что если мы хотим считать в сочетаниям повторение
элементов? Возьмем все то же множество $\{1, 2, 3\}$ и попробуем составить комбинации
из 2 элементов с повторениями.
\begin{equation}
    \{1, 1\}, \{1, 2\}, \{2, 2\}, \{2, 3\}, \{3, 3\}, \{1, 3\}
\end{equation}

Для того чтобы посчитать такое количество комбинаций, придумали 
\textbf{сочетания с повторениями}. Чтобы вывести формулу, можно рассмотреть следующую
ситуацию.

У нас в кармане лежит 3 вида монет с бесконечным количеством: 2, 5, 10 копеечные.
Сколькими способами мы можем достать из кармана 5 монет, причем порядок не имеет значения.
Попробуем нарисовать такую схему: расположим по категорям наши монеты, разделяя их перегородками.
Например, пусть в первой категории лежат только 2, в следующей только 5 и далее 10. Рассмотрим несколько
таких комбинаций:
\begin{gather*}
    2 \ 2 \mid 5 \mid 10 \ 10  \\
    2  \mid 5 \mid 10 \ 10 \ 10 \\
    2 \ 2 \ 2 \mid  \ \mid 10 \ 10 
\end{gather*} 

Можно заметить, что меняя комбинации, мы всего лишь меняем позицию этих перегородок.
Таким образом, если мы имеем $n - 1$ количество перегородок, и $k + (n - 1)$ 
общее количество мест c перегородками, то количество комбинаций, где мы меняем позиции перегородок будет равно:

\begin{equation}\label{eq_comb_with_rep}
    \overline {C^k_n} = C^{n - 1}_{n + k - 1} = C^{k}_{n + k - 1} = \frac{(n + k - 1)!}{k!(n-1)!}
\end{equation}

Формула \ref{eq_comb_with_rep} называется \textbf{сочетания с повторениями}.
\begin{utv}
    \textbf{Сочетания с повторениями} - это количество способов расположить $n$ сортов на $k$ местах,
    причем порядок перестановки неважен.
\end{utv}


\section{Задачи}
Рассмотрим несколько примеров.
\begin{task}
    3 мальчика собрали 50 яблок. Считая яблоки одинаковыми, сколькими способами
    их можно распределить между мальчиками?
    \begin{solution}
        В данной задаче сорт это мальчики, а количество яблок это места. То есть, $n = 3$, $k = 50$.
        \begin{equation*}
            \overline {C^{50}_3} = C^{50}_{52} = \frac{(3+50-1)!}{50!2!} = \frac{52!}{50!2!} = 1326
        \end{equation*}
    \end{solution}
\end{task}

\begin{task}
    Имеется шахматная доска $2n \times 2n$. Сколькими способами можно выбрать а) одну белую
    и одну черную клетки б) и чтобы они не находились на одной вертикали и горизонтали?
    \begin{solution}[a]
        \begin{equation*}
            2n^2 \cdot 2n^2 = 4n^4
        \end{equation*}
    \end{solution}
    \begin{solution}[б]
        \begin{equation*}
            2n^2(2n^2 - 2n) = 4n^3(n - 1)
        \end{equation*}
    \end{solution}
\end{task}

\begin{task}
    Сколькими способами можно составить трехцветный флаг из 5 цветов?
    \begin{solution}
        \begin{equation*}
            A^3_5 = \frac{5!}{2!} = 60
        \end{equation*}
    \end{solution}
\end{task}

\begin{task}
    В группе 12 юношей и 15 девушек. Сколькими способами можно из них составить 4 танцевальные пары?
    \begin{solution}
        Так как в танцевальной паре должен быть 1 мальчик и 1 девочка, то мы должны найти сначала
        количество способов взять 4 мальчика и количество способов взять 4 девочки, а далее сделать перестановку
        между ними.
        \begin{equation*}
            C^4_{12} \cdot C^4_{15} \cdot 4!
        \end{equation*}
    \end{solution}
\end{task}

\begin{task}
    Сколькими способами можно разложить $n_1$ красных, $n_2$ зеленых и $n_3$ синих
    шаров по m урнам?
    \begin{solution}
        Используем формулы сочетаний с повторениями для каждой категории шара.
        \begin{equation*}
            \overline{C^{n_1}_m} \cdot \overline{C^{n_2}_m} \cdot \overline{C^{n_3}_m}
        \end{equation*}
    \end{solution}
\end{task}